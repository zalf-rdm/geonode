{% extends 'geonode_base.html' %}
{% load i18n static %}
{% load bootstrap_tags %}
{% load thesaurus %}
{% load client_lib_tags %}
{% load sanitize_html %}

{% block title %}
  {{ resource.title }} â€” {{ block.super }}
{% endblock %}

{% block body_outer %}

<div class="metadata-title">
  <div class="page-header">
    <h2 class="page-title">
      <strong>{% trans "Metadata" %}:</strong> {{ resource.title }}
    </h2>
  </div>
</div>

<div class="metadata-tabs">

  <!-- Tabs (desktop) -->
  <ul class="nav nav-tabs hidden-xs mb-3" role="tablist">
    <li class="active"><a href="#tab-identification" data-toggle="tab">{% trans "Identification" %}</a></li>
    <li><a href="#tab-responsible" data-toggle="tab">{% trans "Responsible" %}</a></li>
    <li><a href="#tab-projects" data-toggle="tab">{% trans "Projects" %}</a></li>
    <li><a href="#tab-fundings" data-toggle="tab">{% trans "Fundings" %}</a></li>
    <li><a href="#tab-related" data-toggle="tab">{% trans "Related Identifiers" %}</a></li>
    <li><a href="#tab-features" data-toggle="tab">{% trans "Features" %}</a></li>
    <li><a href="#tab-references" data-toggle="tab">{% trans "References" %}</a></li>
  </ul>

  <!-- Accordion (mobile) -->
  <div class="panel-group visible-xs" id="accordion">

    <!-- Identification -->
    <div class="panel panel-default rounded shadow-sm mb-3">
      <div class="panel-heading p-2">
        <h4 class="panel-title">
          <a data-toggle="collapse" data-parent="#accordion" href="#collapse-identification">{% trans "Identification" %}</a>
        </h4>
      </div>
      <div id="collapse-identification" class="panel-collapse collapse in">
        <div class="panel-body p-3 metadata-block">
          <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans "Title" %}</div><div class="col-sm-9">{{ resource.title }}</div></div>
          <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans "Publication Date" %}</div><div class="col-sm-9">{{ resource.date }}</div></div>
          <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans "Type" %}</div><div class="col-sm-9">{{ resource.display_type }}</div></div>
          <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans "Approved" %}</div><div class="col-sm-9">{{ resource.is_approved|yesno:_("Yes,No") }}</div></div>
          <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans "Published" %}</div><div class="col-sm-9">{{ resource.is_published|yesno:_("Yes,No") }}</div></div>
          <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans "Featured" %}</div><div class="col-sm-9">{{ resource.featured|yesno:_("Yes,No") }}</div></div>
          <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans "DOI" %}</div><div class="col-sm-9">{{ resource.doi|default:"-" }}</div></div>
          <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans "Attribution" %}</div><div class="col-sm-9">{{ resource.attribution|default:"-" }}</div></div>
        </div>
      </div>
    </div>

    <!-- Responsible -->
    <div class="panel panel-default rounded shadow-sm mb-3">
      <div class="panel-heading p-2">
        <h4 class="panel-title"><a data-toggle="collapse" data-parent="#accordion" href="#collapse-responsible">{% trans "Responsible" %}</a></h4>
      </div>
      <div id="collapse-responsible" class="panel-collapse collapse">
        <div class="panel-body p-3 metadata-block">
          <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans "Name" %}</div><div class="col-sm-9">{{ resource.owner }}</div></div>
          <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans "Email" %}</div><div class="col-sm-9">{{ resource.owner.email }}</div></div>
          <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans "Organization" %}</div><div class="col-sm-9">{{ resource.owner.organization|default:"-" }}</div></div>
        </div>
      </div>
    </div>

    <!-- Fundings -->
    <div class="panel panel-default rounded shadow-sm mb-3">
      <div class="panel-heading p-2">
        <h4 class="panel-title"><a data-toggle="collapse" data-parent="#accordion" href="#collapse-fundings">{% trans "Fundings" %}</a></h4>
      </div>
      <div id="collapse-fundings" class="panel-collapse collapse">
        <div class="panel-body p-3">
          {% for funding in resource.fundings.all %}
          <div class="metadata-block mb-3 p-3">
            <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans "Organization" %}</div><div class="col-sm-9">{{ funding.organization }}</div></div>
            <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans "Award Number" %}</div><div class="col-sm-9">{{ funding.award_number }}</div></div>
            <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans "Award URI" %}</div><div class="col-sm-9">{{ funding.award_uri }}</div></div>
            <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans "Award Title" %}</div><div class="col-sm-9">{{ funding.award_title }}</div></div>
          </div>
          {% empty %}
          <p><em>{% trans "No fundings available." %}</em></p>
          {% endfor %}
        </div>
      </div>
    </div>

    <!-- Related Identifiers -->
    <div class="panel panel-default rounded shadow-sm mb-3">
      <div class="panel-heading p-2">
        <h4 class="panel-title"><a data-toggle="collapse" data-parent="#accordion" href="#collapse-related">{% trans "Related Identifiers" %}</a></h4>
      </div>
      <div id="collapse-related" class="panel-collapse collapse">
        <div class="panel-body p-3">
          {% if resource.related_identifier.exists %}
            {% for rel in resource.related_identifier.all %}
            <div class="metadata-block mb-3 p-3">
              <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans "Relation Identifier" %}</div><div class="col-sm-9">{{ rel.related_identifier }}</div></div>
              <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans "Related Identifier Type" %}</div><div class="col-sm-9">{{ rel.related_identifier_type }}</div></div>
              <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans "Relation Type" %}</div><div class="col-sm-9">{{ rel.relation_type }}</div></div>
              <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans "Description" %}</div><div class="col-sm-9">{{ rel.description }}</div></div>
            </div>
            {% endfor %}
          {% else %}
            <p><em>{% trans "No related identifiers available." %}</em></p>
          {% endif %}
        </div>
      </div>
    </div>

    <!-- Features -->
    <div class="panel panel-default rounded shadow-sm mb-3">
      <div class="panel-heading p-2">
        <h4 class="panel-title"><a data-toggle="collapse" data-parent="#accordion" href="#collapse-features">{% trans "Features" %}</a></h4>
      </div>
      <div id="collapse-features" class="panel-collapse collapse">
        <div class="panel-body p-3 metadata-block">
          <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans "Projection System" %}</div><div class="col-sm-9">{{ resource.srid|default:"-" }}</div></div>
          <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans "Spatial Extent" %}</div><div class="col-sm-9">{{ resource.bbox_string|default:"-" }}</div></div>
          <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans "Language" %}</div><div class="col-sm-9">{{ resource.language|default:"-" }}</div></div>
        </div>
      </div>
    </div>

    <!-- References -->
    <div class="panel panel-default rounded shadow-sm mb-3">
      <div class="panel-heading p-2">
        <h4 class="panel-title"><a data-toggle="collapse" data-parent="#accordion" href="#collapse-references">{% trans "References" %}</a></h4>
      </div>
      <div id="collapse-references" class="panel-collapse collapse">
        <div class="panel-body p-3 metadata-block">
          <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans "Link Online" %}</div><div class="col-sm-9"><a href="{{ resource.detail_url }}">{{ resource.detail_url }}</a></div></div>
          <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans "Metadata Page" %}</div><div class="col-sm-9"><a href="{{ resource.detail_url }}metadata_detail">{{ resource.detail_url }}metadata_detail</a></div></div>
        </div>
      </div>
    </div>

  </div>

  <!-- Desktop tab content -->
  <div class="tab-content rounded shadow p-3 bg-white hidden-xs">

    <!-- Identification -->
    <div class="tab-pane active" id="tab-identification">
      <h3 class="fw-medium">{% trans "Identification" %}</h3><hr>
      <div class="metadata-block p-3 mb-3">
        <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans "Title" %}</div><div class="col-sm-9">{{ resource.title|default:"-" }}</div></div>
        <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans "Abstract" %}</div><div class="col-sm-9">{{ resource.abstract|default:"-" }}</div></div>
        <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans "Publication Data" %}</div><div class="col-sm-9">{{ resource.date_created|default:"-" }}</div></div>
        <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans "Publication Accepted" %}</div><div class="col-sm-9">{{ resource.date_accepted|default:"-" }}</div></div>
        <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans "Publication Available" %}</div><div class="col-sm-9">{{ resource.date_available|default:"-" }}</div></div>
        <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans "Type" %}</div><div class="col-sm-9">{{ resource.display_type|default:"-" }}</div></div>
        <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans "Approved" %}</div><div class="col-sm-9">{{ resource.is_approved|yesno:_("Yes,No") }}</div></div>
        <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans "Published" %}</div><div class="col-sm-9">{{ resource.is_published|yesno:_("Yes,No") }}</div></div>
        <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans "Featured" %}</div><div class="col-sm-9">{{ resource.featured|yesno:_("Yes,No") }}</div></div>
        <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans "DOI" %}</div><div class="col-sm-9">{{ resource.doi|default:"-" }}</div></div>
        <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans "Attribution" %}</div><div class="col-sm-9">{{ resource.attribution|default:"-" }}</div></div>
      </div>
    </div>

    <!-- Responsible -->
    <div class="tab-pane" id="tab-responsible">
      <h3 class="fw-medium">{% trans "Responsibles" %}</h3><hr>
      <div class="metadata-block p-3 mb-3">
        <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans "Name" %}</div><div class="col-sm-9">{{ resource.owner }}</div></div>
        <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans "Email" %}</div><div class="col-sm-9">{{ resource.owner.email }}</div></div>
        <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans "Organization" %}</div><div class="col-sm-9">{{ resource.owner.organization|default:"-" }}</div></div>
      </div>
      <h3 class="fw-medium">{% trans "Contact Person" %}</h3><hr>
      <div class="metadata-block p-3 mb-3">
        {% if resource.poc %}
          {% for poc in resource.poc %}
              <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans 'Name' %}</div><div class="col-sm-9">{{ poc.name_long|default:"-" }}</div></div>
              <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans 'Email' %}</div><div class="col-sm-9">{{ poc.email|default:"-" }}</div></div>
              <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans 'Position' %}</div><div class="col-sm-9">{{ poc.position|default:"-" }}</div></div>
              <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans 'Organization' %}</div><div class="col-sm-9">{{ poc.organization|default:"-" }}</div></div>
              <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans 'Location' %}</div><div class="col-sm-9">{{ poc.location|default:"-" }}</div></div>
              <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans 'Voice' %}</div><div class="col-sm-9">{{ poc.voice|default:"-" }}</div></div>
              <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans 'Fax' %}</div><div class="col-sm-9">{{ poc.fax|default:"-" }}</div></div>
              {% if poc.keyword_list %}
              <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans 'Keywords' %}</div><div class="col-sm-9">{% for keyword in poc.keyword_list %}{{ keyword }}{% if not forloop.last %}, {% endif %}{% endfor %}</div></div>
              {% endif %}
          {% endfor %}
        {% endif %}

      </div>
      <h3 class="fw-medium">{% trans "Metadata Author" %}</h3><hr>
        {% if resource.metadata_author %}
          {% for metadata_author in resource.metadata_author %}
            <div class="metadata-block p-3 mb-3">
              <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans 'Name' %}</div><div class="col-sm-9">{{ metadata_author.name_long|default:"-" }}</div></div>
              <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans 'Email' %}</div><div class="col-sm-9">{{ metadata_author.email|default:"-" }}</div></div>
              <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans 'Position' %}</div><div class="col-sm-9">{{ metadata_author.position|default:"-" }}</div></div>
              <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans 'Organization' %}</div><div class="col-sm-9">{{ metadata_author.organization|default:"-" }}</div></div>
              <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans 'Location' %}</div><div class="col-sm-9">{{ metadata_author.location|default:"-" }}</div></div>
              <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans 'Voice' %}</div><div class="col-sm-9">{{ metadata_author.voice|default:"-" }}</div></div>
              <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans 'Fax' %}</div><div class="col-sm-9">{{ metadata_author.fax|default:"-" }}</div></div>
              {% if metadata_author.keyword_list %}
              <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans 'Keywords' %}</div><div class="col-sm-9">{% for keyword in metadata_author.keyword_list %}{{ keyword }}{% if not forloop.last %}, {% endif %}{% endfor %}</div></div>
              {% endif %}
            </div>
          {% endfor %}
        {% endif %}
    </div>

    <!-- Projects -->
    <div class="tab-pane" id="tab-projects">
      <h3 class="fw-medium">{% trans "Projects" %}</h3><hr>
      {% if resource.related_projects.exists %}
        {% for rel in resource.related_projects.all %}
        <div class="metadata-block p-3 my-3">
          <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans "Related Project Label" %}</div><div class="col-sm-9">{{ rel.label|default:"-" }}</div></div>
          <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans "Related Project Name" %}</div><div class="col-sm-9">{{ rel.display_name|default:"-" }}</div></div>
          <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans "Related Project Description" %}</div><div class="col-sm-9">{{ rel.description|default:"-" }}</div></div>
        </div>
        {% endfor %}
      {% else %}
        <p><em>{% trans "No Projects available." %}</em></p>
      {% endif %}
    </div>

    <!-- Fundings -->
    <div class="tab-pane" id="tab-fundings">
      <h3 class="fw-medium">{% trans "Fundings" %}</h3><hr>
      {% if resource.fundings.exists %}
        {% for funding in resource.fundings.all %}
        <div class="metadata-block p-3 my-3">
          <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans "Organization" %}</div><div class="col-sm-9">{{ funding.organization }}</div></div>
          <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans "Award Number" %}</div><div class="col-sm-9">{{ funding.award_number }}</div></div>
          <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans "Award URI" %}</div><div class="col-sm-9">{{ funding.award_uri }}</div></div>
          <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans "Award Title" %}</div><div class="col-sm-9">{{ funding.award_title }}</div></div>
        </div>
        {% endfor %}
      {% else %}
        <p><em>{% trans "No fundings available." %}</em></p>
      {% endif %}
    </div>

    <!-- Related Identifiers -->
    <div class="tab-pane" id="tab-related">
      <h3 class="fw-medium">{% trans "Related Identifiers" %}</h3><hr>
      {% if resource.related_identifier.exists %}
        {% for rel in resource.related_identifier.all %}
        <div class="metadata-block p-3 my-3">
          <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans "Relation Identifier" %}</div><div class="col-sm-9">{{ rel.related_identifier }}</div></div>
          <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans "Related Identifier Type" %}</div><div class="col-sm-9">{{ rel.related_identifier_type }}</div></div>
          <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans "Relation Type" %}</div><div class="col-sm-9">{{ rel.relation_type }}</div></div>
          <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans "Description" %}</div><div class="col-sm-9">{{ rel.description }}</div></div>
        </div>
        {% endfor %}
      {% else %}
        <p><em>{% trans "No related identifiers available." %}</em></p>
      {% endif %}
    </div>

    <!-- Features -->
    <div class="tab-pane" id="tab-features">
      <h3 class="fw-medium">{% trans "Features" %}</h3><hr>
      <div class="metadata-block p-3 my-3">
        <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans "Edition" %}</div><div class="col-sm-9">{{ resource.edition|default:"-" }}</div></div>
        <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans "Language" %}</div><div class="col-sm-9">{{ resource.language|default:"-" }}</div></div>
        <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans "Data Quality" %}</div><div class="col-sm-9">{{ resource.data_quality_statement }}</div></div>
        <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans "Supplemental Information" %}</div><div class="col-sm-9">{{ resource.supplemental_information|sanitize_html|safe }}</div></div>
        
      </div>
      <h3 class="fw-medium mt-5">{% trans "GeoInformation" %}</h3><hr>
      <div class="metadata-block p-3 my-3">
        <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans "Identification Image" %}</div><a href="{{ resource.get_thumbnail_url }}"><img class="p-4" ng-src="{{ resource.get_thumbnail_url }}" src="{{ resource.get_thumbnail_url }}" /></a></div>
        <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans "Projection System" %}</div><div class="col-sm-9">{{ resource.srid|default:"-" }}</div></div>
        <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans "Spatial Extent" %}</div><div class="col-sm-9">{{ resource.bbox_string|default:"-" }}</div></div>
        <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans "Extension x0" %}</div><div class="col-sm-9">{{ resource.bbox_x0|default:"-" }}</div></div>
        <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans "Extent x1" %}</div><div class="col-sm-9">{{ resource.bbox_x1|default:"-" }}</div></div>
        <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans "Extent y0" %}</div><div class="col-sm-9">{{ resource.bbox_y0|default:"-" }}</div></div>
        <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans "Extent x1" %}</div><div class="col-sm-9">{{ resource.bbox_y1|default:"-" }}</div></div>
      </div>
    </div>

    <!-- References -->
    <div class="tab-pane" id="tab-references">
      <h3 class="fw-medium">{% trans "References" %}</h3><hr>
      <div class="metadata-block p-3 my-3">
        
        <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans "Link Online" %}</div><div class="col-sm-9"><a href="{{ resource.get_absolute_url }}">{{ resource.get_absolute_url }}</a></div></div>
        <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans "Metadata Page" %}</div><div class="col-sm-9"><a href="{{ resource.get_absolute_url }}/metadata_detail">{{ resource.get_absolute_url }}/metadata_detail</a></div></div>
        {% if resource.doc_file %}
        <div class="row mb-2"><div class="col-sm-3 fw-semibold">{% trans "Online Link" %}</div><div class="col-sm-9"><a href="{{ resource.get_absolute_url }}/download">{{ resource.get_absolute_url }}/download</a></div></div>
        {% endif %}
        {% if 'download_resourcebase' in perms_list %}
          {% for link in resource.link_set.download %}
          <div class="row mb-2"><div class="col-sm-3 fw-semibold">{{ link.name }}</div><div class="col-sm-9"><a href="{{ link.url }}">{{ resource.title }}.{{ link.extension }}</a></div></div>
          {% endfor %}
        {% endif %}
        {% for link in resource.link_set.ows %}
        <div class="row mb-2"><div class="col-sm-3 fw-semibold">{{ link.name }}</div><div class="col-sm-9"><a href="{{ link.url }}">Geoservice {{ link.link_type }}</a></div></div>
        {% endfor %}
      </div>

    </div>

  </div>
</div>

{% endblock %}

{% block extra_head %}
{{ block.super }}
  <link rel="stylesheet" href="{% static 'geonode/css/zalf_theme_metadata.css' %}">
{% endblock %}

{% block extra_script %}
<script>
  $(document).ready(function() {
    $('.panel-collapse').on('show.bs.collapse', function () {
      $(this).siblings('.panel-heading').addClass('active');
    }).on('hide.bs.collapse', function () {
      $(this).siblings('.panel-heading').removeClass('active');
    });
  });
</script>
{% endblock %}
